# Plan B
## Part Ⅰ
> 1. MC9S12XS128是飞思卡尔出品的一款***16***位的,在飞思卡尔的命名规则中,128表示  ___内含128位的Flash存储器___  
> 2.  利用监控程序查看MC9S12XS128内部全部存储器,使用的指令是***R***,显示内存的命令是***D***。
> 3. MC9S12XS128单片机共有6种复位操作,分别是***上电复位,低电压复位,看门狗复位,非法地址复位,外部复位,时钟故障复位。***
> 4. C程序中导出符号***XDEF***,导入符号指令***XREF***。
> 5. MC9S12XS128单片机汇编程序设计中子程序调用指令***RTS,RTC***。
> 6. SPI的自定义接口MOSI是***数据输出***线,MISO是***数据接收***线。
> 7. 在MC9S12XS128中使用汇编语言中断服务程序时,中断服务子程序的最后一条指令必须是***RTI***,中断服务程序只能定位在***内容***内存中.
> 8. MC9S12XS128的四个PAGE寄存器***EPAGE，RPAGE，PPAGE，GPAGE***。
> 9. MC9S12XS128有***8***KB的数据闪存，***128***KB的SRAM。

___

## PART Ⅱ
> 1. 下列不属于MC9S12XS128的CPU寄存器的是 ***PPAGE***
> 2. MC9S12XS128不包括什么模块 ***USB模块***
> 3. 在MC9S12XS128汇编指令的一行这种，哪一项是不可缺少的 ***操作码***
> 4. 下列不属于跳转指令的是 ***RTI***
> 5. 用于编辑存储器的监控指令是***M*** , 用于擦除程序内存的指令是***E***
> 6. MC9S12XS128 发生中断最先栈如的存储器是***PC***,最后栈入的是***CCR***
> 7. 不属于工程项目文件的是___.exe___
> 8. MC9S12XS128内部SRAM存储器可以使用的页面地址为***0X0000-0XFFFF***数据闪存所使用的页内地址为***$03~$04***
> 9. SCIODRL 是SCIO端口的***数据寄存器***,SCLIOBDH是SCIO端口的***波特率寄存器***
___

## PART Ⅲ
1. 简述CPU12XS的中断处理过程中的进栈和出栈的顺序
> 寄存器PC，Y，X，D，CCR，依次进栈   
> RTI指令依次从栈中取出CCR，D，X，Y，PC。

2. 简述单片机串行控制程序一般需要实现的功能
> 1. 实现人机交互  ,
> 2. 使用户可以查看单片机内的各种资源，包括寄存器、存储器；  
> 3. 使用户可以修改单片机内的各种资源，包括寄存器、存储器；  
> 4. 用户可以向单片机系统内存中装载程序；  
> 5. 用户可以从内存任意地址开始执行程序。  
> 6. 能在被调试程序中设置断点，观察程序执行过程 . 

3. 简述MC9S12XS128单片机中的程序闪存是怎么组织的，以及MC9S12XS128的具体情况
> MC9S12XS128的程序闪存有128K，分成8个16k的扇区，每个扇区有256个64字节的页，地址范围是$4000-$BFFF。
> MC9S12XS 系列单片机中的程序闪存（P-Flash）是由不同数量的 16 KB 的扇区组成.

4. 简述一般嵌入式C编译器提供的标准启动代码流程内容
> 1. 初始化堆栈寄存器；  
> 2. 清零所有变量占用的RAM内存空间  
> 3. 把带初始化值的变量的初始化值ROM复制到RAM中  
> 4. 调用main函数  
> 5. 自陷，防止程序飞跑  

___

## PART Ⅳ
1. 对于MC9S12XS128，假设内部总线时钟为8MHIz，要求编程周期中断定时器模块PIT,设定定时周期0.5s，每次定时中断到来时将portb的输出电平翻转。要求给出完整程序，包括初始化程序、主程序、中断服务程序、中断矢量表。（注意：要求必须用汇编语言写，假设XS128设备定义汇编头文件为MC9S12XS128.inc,DDRB 和PORTB定义为PORTB的数据方向寄存器和数据端口寄存器，PITCFLMT、PITCE、PITMUX、PITMTLDO、PITLDO、PITINTE、PITTF 分别定义为PIT控制寄存器、通道使能寄存器、复用寄存器、微计数器加载寄存器0、加载寄存器0、中断使能寄存器、超时标志寄存器。假设PIT通道0中断欠量地址为$FF7A。)  

___该代码由神奇的chatgpt生成，由于chatgpt每次生成的代码都不一样且宕机两次，故不保证代码的正确性___
```
INCLUDE 'MC9S12XS128.inc'  ; 包含MC9S12XS128的汇编头文件

ORG $4000  ; 程序起始地址

; 中断向量表
ORG $FF80
DC.W PIT_ISR  ; PIT通道0中断服务程序

; 初始化程序
INIT:
    LDA #$00  ; 清零PORTB
    STA DDRB
    STA PORTB

    LDA #$00  ; 禁用PIT中断
    STA PITINTE

    LDA #$00  ; 设置PIT通道0的定时周期为0.5秒
    STA PITMTLDO
    LDA #$C3  ; 加载微计数器的值，使得定时器周期为0.5秒
    STA PITLDO

    LDA #$01  ; 使能PIT通道0的中断和定时器
    STA PITCE
    STA PITCFLMT

    CLI  ; 开启中断

; 主程序
MAIN:
    NOP  ; 空操作

; 中断服务程序
PIT_ISR:
    PSHA  ; 保存现场
    LDA PITTF  ; 读取PIT通道0的超时标志寄存器，清除中断标志
    STA PITTF

    LDA PORTB  ; 读取PORTB的输出电平
    EORA #$FF  ; 翻转输出电平
    STA PORTB  ; 更新PORTB的输出电平

    PULA  ; 恢复现场
    RTI  ; 返回中断

END  ; 程序结束

```
2. 写一个S12XS中将系统时钟初始化为80MHz(此时总线时钟为40MHz)的程序（默认晶振频率为16MHz）。

```C
Void  SetBusCLK_40M(void)
{
CLKSEL_PLLSEL = 0;//不使能锁相环时钟
PLLCTL_PLLON  = 1;//锁相环电路允许
REFDV=0x80|0x07  ;
SYNR=0xC0|0x13   ;//VOC_clock = 80MHz
POSTDIV=0x00     ;// PLL_clock = VOC_clock = 80MHz
  _asm(nop);
  _asm(nop);
while(!(CRGFLG_LOCK == 1));//时钟频率稳定，锁相环频率锁定
    CLKSEL_PLLSEL = 1;//使能锁相环时钟
}

```
